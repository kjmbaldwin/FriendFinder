<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Friend Finder Survey</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.0.0/js/all.js"></script>
    
  </head>
  <body>

    <section class="hero is-medium is-primary is-bold">
        <div class="hero-body">
          <div class="container">
            <h1 class="title">
              Friend Finder
            </h1>
            <h2 class="subtitle">
              Find a friend, and then who knows that will happen!
            </h2>
          </div>
        </div>
    </section>

    <div class="container">
      <section class="section is-medium">
        
        <h1 class="title">Survey Questions:</h1>
        <hr>

        <div class="field">
          <label class="label">Name</label>
          <div class="control">
            <input class="input" id="name" type="text" placeholder="e.g John Smith">
          </div>
        </div>
        
        <div class="field">
          <label class="label">Link to photo</label>
          <div class="control">
            <input class="input" id="photo" type="email" placeholder="e.g. https://gph.is/2Grv2eu">
          </div>
        </div>  
        <hr>

        <div class="field">
          <label class="label">Question 1:</label>
          <label class="label">This is the question</label>
          <div class="control">
            <div class="select" >
              <select id="q1">
                <option>Select Answer</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
              </select>
            </div>
          </div>
        </div>

        <div class="field">
          <label class="label">Question 2:</label>
          <label class="label">This is the question</label>
          <div class="control">
            <div class="select">
              <select id="q2">
                <option>Select Answer</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
              </select>
            </div>
          </div>
        </div>

        <div class="field">
          <label class="label">Question 3:</label>
          <label class="label">This is the question</label>
          <div class="control">
            <div class="select">
              <select id="q3">
                <option>Select Answer</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
              </select>
            </div>
          </div>
        </div>

        <div class="field">
          <label class="label">Question 4:</label>
          <label class="label">This is the question</label>
          <div class="control">
            <div class="select">
              <select id="q4">
                <option>Select Answer</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
              </select>
            </div>
          </div>
        </div>

        <div class="field">
          <label class="label">Question 5:</label>
          <label class="label">This is the question</label>
          <div class="control">
            <div class="select">
              <select id="q5">
                <option>Select Answer</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
              </select>
            </div>
          </div>
        </div>

        <div class="field">
          <label class="label">Question 6:</label>
          <label class="label">This is the question</label>
          <div class="control">
            <div class="select">
              <select id="q6">
                <option>Select Answer</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
              </select>
            </div>
          </div>
        </div>

        <div class="field">
          <label class="label">Question 7:</label>
          <label class="label">This is the question</label>
          <div class="control">
            <div class="select">
              <select id="q7">
                <option>Select Answer</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
              </select>
            </div>
          </div>
        </div>

        <div class="field">
          <label class="label">Question 8:</label>
          <label class="label">This is the question</label>
          <div class="control">
            <div class="select">
              <select id="q8">
                <option>Select Answer</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
              </select>
            </div>
          </div>
        </div>

        <div class="field">
          <label class="label">Question 9:</label>
          <label class="label">This is the question</label>
          <div class="control">
            <div class="select">
              <select id="q9">
                <option>Select Answer</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
              </select>
            </div>
          </div>
        </div>

        <div class="field">
          <label class="label">Question 10:</label>
          <label class="label">This is the question</label>
          <div class="control">
            <div class="select">
              <select id="q10">
                <option>Select Answer</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
              </select>
            </div>
          </div>
        </div>


        <div class="field">
          <div class="control">
            <button class="button is-primary is-large" id="survey-submit-btn">Submit Survey</button>
          </div>
        </div>
        <hr>
        
      </section>
    </div>

    <div class="modal">
        <div class="modal-background"></div>
        <div class="modal-card">
          <header class="modal-card-head">
            <p class="modal-card-title">Your closest match:</p>
            <button class="delete" aria-label="close"></button>
          </header>
          <section class="modal-card-body">
            <!-- Content ... -->
          </section>
          <footer class="modal-card-foot">
            <button class="close is-primary">Close</button>
          </footer>
        </div>
      </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

    <script text="text/javascript">

    

      $('#survey-submit-btn').on('click', function(event){
        event.preventDefault();
    
        
        
        var scoresArray = [];
        for (let index = 1; index < 11; index++) {
          scoresArray.push($('#q' + index).val());         
        }

        var newSurvey = {
          name: $('#name').val().trim(),
          photo: $('#photo').val().trim(),
          scores: scoresArray
        };
        
        //error checking
        // console.log(newSurvey);

        $.post("/api/new", newSurvey, function(data) {

          console.log("Your best friend: ", data);
            var name = data.name;
            var photo = data.photo;

            $(".modal-card-body").html(
              "<h1>" + name + "</h1>" +
              "<img src=\"" + photo + "\" />"
            );

            $(".modal").addClass("is-active");
        });
      });

      $('.close, .delete').click(function (){
        $('.modal').removeClass("is-active");  
      });
      
    </script>
  </body>
</html>